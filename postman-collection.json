{
  "info": {
    "name": "PRN232 LAB2 - REST API Tests",
    "description": "Final Structure: GET List split into separate requests (Search, Sort, Paging) matches the image. All requests have Schema Validation & Logic.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "createdCategoryId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Auth",
      "item": [
        {
          "name": "Login - Success",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Test 1: Check HTTP Status",
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "// Logic: If/Else for Safety",
                  "if (pm.response.code === 200) {",
                  "    // Test 2: Check JSON Schema",
                  "    const schema = {",
                  "        \"type\": \"object\",",
                  "        \"required\": [\"success\", \"data\"],",
                  "        \"properties\": {",
                  "            \"success\": { \"type\": \"boolean\" },",
                  "            \"data\": {",
                  "                \"type\": \"object\",",
                  "                \"required\": [\"token\"],",
                  "                \"properties\": {",
                  "                    \"token\": { \"type\": \"string\" }",
                  "                }",
                  "            }",
                  "        }",
                  "    };",
                  "    pm.test(\"Response matches Login Schema\", function () {",
                  "        pm.response.to.have.jsonSchema(schema);",
                  "    });",
                  "",
                  "    // Save Token",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data) {",
                  "        var token = jsonData.data.token || jsonData.data.Token || jsonData.data.accessToken;",
                  "        if (token) {",
                  "            pm.collectionVariables.set(\"token\", token);",
                  "            console.log(\"Token saved successfully\");",
                  "        }",
                  "    }",
                  "} else {",
                  "    console.log(\"Login failed with status: \" + pm.response.code);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"accountEmail\": \"admin@FUNewsManagementSystem.org\",\n  \"accountPassword\": \"@@abc123@@\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "auth",
                "login"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "2. Categories",
      "item": [
        {
          "name": "Get List (Split Requests)",
          "item": [
            {
              "name": "Get All Categories - Default Paging",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Custom Page Size",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\", \"pageSize\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?page=1&pageSize=5",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "pageSize",
                      "value": "5"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Search by Name",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?name=Academic",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "name",
                      "value": "Academic"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Filter by Active",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?isActive=true",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "isActive",
                      "value": "true"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Filter by Inactive",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?isActive=false",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "isActive",
                      "value": "false"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Sort by Name ASC",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?sortBy=CategoryName&isDescending=false",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "sortBy",
                      "value": "CategoryName"
                    },
                    {
                      "key": "isDescending",
                      "value": "false"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Sort by Name DESC",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?sortBy=CategoryName&isDescending=true",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "sortBy",
                      "value": "CategoryName"
                    },
                    {
                      "key": "isDescending",
                      "value": "true"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Categories - Combined Search",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () { pm.response.to.have.status(200); });",
                      "if(pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"data\"], \"properties\": { \"data\": { \"required\": [\"items\"] } } };",
                      "    pm.test(\"Schema Valid\", function() { pm.response.to.have.jsonSchema(schema); });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories?name=a&isActive=true&page=1&pageSize=5",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ],
                  "query": [
                    {
                      "key": "name",
                      "value": "a"
                    },
                    {
                      "key": "isActive",
                      "value": "true"
                    },
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "pageSize",
                      "value": "5"
                    }
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Create Category",
          "item": [
            {
              "name": "POST Create - Success",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 201\", function () {",
                      "    pm.response.to.have.status(201);",
                      "});",
                      "",
                      "if (pm.response.code === 201) {",
                      "    var schema = {",
                      "        \"type\": \"object\",",
                      "        \"required\": [\"success\", \"data\"],",
                      "        \"properties\": {",
                      "            \"data\": { \"required\": [\"categoryId\", \"categoryName\"] }",
                      "        }",
                      "    };",
                      "    pm.test(\"Schema Valid\", function () {",
                      "        pm.response.to.have.jsonSchema(schema);",
                      "    });",
                      "",
                      "    var jsonData = pm.response.json();",
                      "    if (jsonData.data) {",
                      "        var id = jsonData.data.categoryId || jsonData.data.CategoryId;",
                      "        pm.collectionVariables.set(\"createdCategoryId\", id);",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"categoryName\": \"Test Schema Category\",\n  \"categoryDesciption\": \"Created via Postman\",\n  \"isActive\": true\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ]
                }
              }
            },
            {
              "name": "POST Create - Bad Request",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 400\", function () {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "pm.test(\"Error Schema Valid\", function () {",
                      "    var json = pm.response.json();",
                      "    pm.expect(json.errors || json.message).to.exist;",
                      "});"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"categoryName\": \"\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories"
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Update Category",
          "item": [
            {
              "name": "PUT Update - Success",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "if (pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"message\"] };",
                      "    pm.test(\"Schema Valid\", function () {",
                      "        pm.response.to.have.jsonSchema(schema);",
                      "    });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"categoryName\": \"Updated Name Schema\",\n  \"categoryDesciption\": \"Updated Description\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories/{{createdCategoryId}}",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories",
                    "{{createdCategoryId}}"
                  ]
                }
              }
            },
            {
              "name": "PUT Update - Bad Request",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 400\", function () {",
                      "    pm.response.to.have.status(400);",
                      "});",
                      "",
                      "pm.test(\"Error Schema Valid\", function () {",
                      "    var json = pm.response.json();",
                      "    pm.expect(json.errors || json.message).to.exist;",
                      "});"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"categoryName\": \"\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories/{{createdCategoryId}}",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories",
                    "{{createdCategoryId}}"
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Delete Category",
          "item": [
            {
              "name": "DELETE - Success",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test(\"Status code is 200\", function () {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "",
                      "if (pm.response.code === 200) {",
                      "    var schema = { \"type\": \"object\", \"required\": [\"success\", \"message\"] };",
                      "    pm.test(\"Schema Valid\", function () {",
                      "        pm.response.to.have.jsonSchema(schema);",
                      "    });",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{token}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/categories/{{createdCategoryId}}",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "categories",
                    "{{createdCategoryId}}"
                  ]
                }
              }
            }
          ]
        }
      ]
    }
  ]
}